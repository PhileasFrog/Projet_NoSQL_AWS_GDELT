{"paragraphs":[{"text":"import org.apache.spark.sql.functions._\nimport scala.collection.mutable.ArrayBuffer\nimport org.apache.spark.input.PortableDataStream\nimport java.util.zip.ZipInputStream\nimport java.io.BufferedReader\nimport java.io.InputStreamReader","user":"anonymous","dateUpdated":"2021-01-27T17:24:58+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.functions._\nimport scala.collection.mutable.ArrayBuffer\nimport org.apache.spark.input.PortableDataStream\nimport java.util.zip.ZipInputStream\nimport java.io.BufferedReader\nimport java.io.InputStreamReader\n"}]},"apps":[],"jobName":"paragraph_1611766400374_1545257441","id":"20210114-202121_136172096","dateCreated":"2021-01-27T16:53:20+0000","dateStarted":"2021-01-27T17:24:58+0000","dateFinished":"2021-01-27T17:24:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10610"},{"text":"def DataFile(directory :String)={\n    val data = sc.binaryFiles(directory).\n      flatMap { // decompresser les fichiers\n        case (name: String, content: PortableDataStream) =>\n        val zis = new ZipInputStream(content.open)\n      Stream.continually(zis.getNextEntry).\n        takeWhile{ case null => zis.close(); false\n        case _ => true }.\n        flatMap { _ =>\n          val br = new BufferedReader(new InputStreamReader(zis))\n          Stream.continually(br.readLine()).takeWhile(_ != null)}\n          \n      }\n    data\n    }\n\ndef language(tmp: String) : String ={\n    if (tmp == \"\") {\n        \"eng\"\n    } \n    else {\n      tmp.split(\";\")(0).takeRight(3)  \n    }\n    \n}\n\nval language_udf = udf(language _)","user":"anonymous","dateUpdated":"2021-01-27T17:24:59+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFile: (directory: String)org.apache.spark.rdd.RDD[String]\nlanguage: (tmp: String)String\nlanguage_udf: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,StringType,Some(List(StringType)))\n"}]},"apps":[],"jobName":"paragraph_1611766400378_1266214138","id":"20210116-211833_111367244","dateCreated":"2021-01-27T16:53:20+0000","dateStarted":"2021-01-27T17:24:59+0000","dateFinished":"2021-01-27T17:25:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10611"},{"text":"// A modifier pour rediriger vers bucket S3 du compte AWS\n// val DIRS3PERSO=\"premierbuckerdom1012\" //Dominique\nval DIRS3PERSO=\"bcobucket-telecom-2020\" //Bertrand\n//val DIRS3PERSO=\"thomas-trivellato-gdelt2020\" //Tom\n//val DIRS3PERSO=\"rob-nob-telecom-gdelt2020\" //Roberto","user":"anonymous","dateUpdated":"2021-01-27T17:25:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DIRS3PERSO: String = bcobucket-telecom-2020\n"}]},"apps":[],"jobName":"paragraph_1611766400378_-1098114009","id":"20210119-212848_913043879","dateCreated":"2021-01-27T16:53:20+0000","dateStarted":"2021-01-27T17:25:00+0000","dateFinished":"2021-01-27T17:25:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10612"},{"text":"// Déclaration des chemins dans S3\n\nval DIR_zips = \"s3://\" + DIRS3PERSO + \"/zips/\" \nval DATE_files = \"202004*\" // Filtre pour test pour passage à l'échelle\nval PATH_files = DIR_zips + DATE_files\nval DIR_Parquet = \"s3://\" + DIRS3PERSO + \"/parquets/\"\n\n","user":"anonymous","dateUpdated":"2021-01-27T17:30:52+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DIR_zips: String = s3://bcobucket-telecom-2020/zips/\nDATE_files: String = 2020040101*\nPATH_files: String = s3://bcobucket-telecom-2020/zips/2020040101*\nDIR_Parquet: String = s3://bcobucket-telecom-2020/parquets/\n"}]},"apps":[],"jobName":"paragraph_1611766400378_1938734631","id":"20210116-212115_1461421196","dateCreated":"2021-01-27T16:53:20+0000","dateStarted":"2021-01-27T17:25:00+0000","dateFinished":"2021-01-27T17:25:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10613"},{"text":"// Récupération de zip en RDD\n\nval gkgRDD = DataFile(PATH_files + \".gkg.csv.zip\")\nval eventRDD = DataFile(PATH_files + \".export.CSV.zip\")\nval mentionsRDD = DataFile(PATH_files + \".mentions.CSV.zip\")","user":"anonymous","dateUpdated":"2021-01-27T17:25:01+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"gkgRDD: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[184] at flatMap at <console>:49\neventRDD: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[186] at flatMap at <console>:49\nmentionsRDD: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[188] at flatMap at <console>:49\n"}]},"apps":[],"jobName":"paragraph_1611766400379_-2134124411","id":"20210116-212206_1239265297","dateCreated":"2021-01-27T16:53:20+0000","dateStarted":"2021-01-27T17:25:01+0000","dateFinished":"2021-01-27T17:25:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10614"},{"text":"%md\n## Construction des 3 dataframes pour toutes les queries","user":"anonymous","dateUpdated":"2021-01-27T17:25:01+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Construction des 3 dataframes pour toutes les queries</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1611766400379_1026298406","id":"20210116-213821_818735155","dateCreated":"2021-01-27T16:53:20+0000","dateStarted":"2021-01-27T17:25:01+0000","dateFinished":"2021-01-27T17:25:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10615"},{"text":"val gkg_all = gkgRDD.toDF. \nwithColumn(\"dategkg\",split($\"value\",\"\\\\t\").getItem(1)).\nwithColumn(\"sourcecommonname\",split($\"value\",\"\\\\t\").getItem(3)).\nwithColumn(\"mentionid\",split($\"value\",\"\\\\t\").getItem(4)).\nwithColumn(\"theme\",split(lower($\"value\"),\"\\\\t\").getItem(7)).\nwithColumn(\"locations\", split($\"value\", \"\\\\t\").getItem(9)).\nwithColumn(\"persons\", split($\"value\", \"\\\\t\").getItem(11)).\nwithColumn(\"tone\", split($\"value\", \"\\\\t\").getItem(15)).\nfilter(upper($\"theme\").contains(\"COVID\")||upper($\"theme\").contains(\"CORONAVIRUS\")).\ndrop(\"value\")\n\nval mentions_all = mentionsRDD.toDF.\nwithColumn(\"globaleventid\", split($\"value\", \"\\\\t\").getItem(0).cast(\"Int\")).\nwithColumn(\"day_mention\", split($\"value\", \"\\\\t\").getItem(2)).\nwithColumn(\"mentionid\", split($\"value\", \"\\\\t\").getItem(5)).\nwithColumn(\"langue\",split($\"value\",\"\\\\t\").getItem(14)).\ndrop(\"value\")\n\nval event_all = eventRDD.toDF.\nwithColumn(\"globaleventid\", split($\"value\", \"\\\\t\").getItem(0).cast(\"Int\")).\nwithColumn(\"date\", split($\"value\", \"\\\\t\").getItem(1).cast(\"Int\")).\nwithColumn(\"monthyear\", split($\"value\", \"\\\\t\").getItem(2).cast(\"Int\")).\nwithColumn(\"year\", split($\"value\", \"\\\\t\").getItem(3).cast(\"Int\")).\nwithColumn(\"paysaction\", split($\"value\", \"\\\\t\").getItem(53)).\ndrop(\"value\")\n\n","user":"anonymous","dateUpdated":"2021-01-27T17:25:01+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"gkg_all: org.apache.spark.sql.DataFrame = [dategkg: string, sourcecommonname: string ... 5 more fields]\nmentions_all: org.apache.spark.sql.DataFrame = [globaleventid: int, day_mention: string ... 2 more fields]\nevent_all: org.apache.spark.sql.DataFrame = [globaleventid: int, date: int ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1611766400379_1427102331","id":"20210116-212740_32546234","dateCreated":"2021-01-27T16:53:20+0000","dateStarted":"2021-01-27T17:25:01+0000","dateFinished":"2021-01-27T17:25:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10616"},{"text":"// gkg_all.show()","user":"anonymous","dateUpdated":"2021-01-27T17:25:02+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1611766400379_-1541004653","id":"20210120-215531_1334137219","dateCreated":"2021-01-27T16:53:20+0000","dateStarted":"2021-01-27T17:25:02+0000","dateFinished":"2021-01-27T17:25:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10617"},{"text":"%md\n# Construction des dataframes pour Query 1\n## Afficher le nombre d’articles/évènements qui parlent de COVID qu’il y a eu pour chaque triplet (jour, pays de l’évènement, langue de l’article).","user":"anonymous","dateUpdated":"2021-01-27T17:25:03+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Construction des dataframes pour Query 1</h1>\n<h2>Afficher le nombre d’articles/évènements qui parlent de COVID qu’il y a eu pour chaque triplet (jour, pays de l’évènement, langue de l’article).</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1611766400380_-1577251574","id":"20210114-214202_2078175595","dateCreated":"2021-01-27T16:53:20+0000","dateStarted":"2021-01-27T17:25:03+0000","dateFinished":"2021-01-27T17:25:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10618"},{"text":"%md\nOn va commencer par filtrer sur les données de gkg via la colonne theme. On utilise ensuite la colonne avec l'url de l'article comme clef étrangère pour jointure avec la table mention. On pourra ensuite voir pour chaque article l'évenement cité. On récupère le pays et la date de l'évenement dans la table events via jointure sur globaleventid","user":"anonymous","dateUpdated":"2021-01-27T17:25:03+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>On va commencer par filtrer sur les données de gkg via la colonne theme. On utilise ensuite la colonne avec l&rsquo;url de l&rsquo;article comme clef étrangère pour jointure avec la table mention. On pourra ensuite voir pour chaque article l&rsquo;évenement cité. On récupère le pays et la date de l&rsquo;évenement dans la table events via jointure sur globaleventid</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1611766400380_-2146789384","id":"20210117-120921_723508652","dateCreated":"2021-01-27T16:53:20+0000","dateStarted":"2021-01-27T17:25:03+0000","dateFinished":"2021-01-27T17:25:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10619"},{"text":"%md\nQuery1","user":"anonymous","dateUpdated":"2021-01-27T17:25:03+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Query1</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1611766400380_1585414273","id":"20210116-213047_777635428","dateCreated":"2021-01-27T16:53:20+0000","dateStarted":"2021-01-27T17:25:03+0000","dateFinished":"2021-01-27T17:25:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10620"},{"text":"// Pour la Query comme on a déjà filtré sur le thème pour Covid et que gkgid et mentionid sont unique on ne sélectionne que mentionid pour faire la jointure\n\nval gkg = gkg_all.select(\"mentionid\")\n//gkg.head()\n//gkg.select(gkg.columns.map(c => countDistinct(col(c)).alias(c)): _*).show // pour faire un count des valeur unique par colonne\n\nval mentions = mentions_all.select(\"mentionid\",\"globaleventid\",\"langue\",\"day_mention\").\nwithColumn(\"langue\",language_udf($\"langue\"))\n//mentions.head()\n// mentions.printSchema\n\nval events = event_all.select(\"globaleventid\",\"date\",\"paysaction\").\nfilter($\"paysaction\"!==\"\") // il y a des lignes vides non informées on les enlèves dès l'import\n//events.head()\n// events.printSchema\n//events.select(events.columns.map(c => countDistinct(col(c)).alias(c)): _*).show */","user":"anonymous","dateUpdated":"2021-01-27T17:25:03+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"gkg: org.apache.spark.sql.DataFrame = [mentionid: string]\nmentions: org.apache.spark.sql.DataFrame = [mentionid: string, globaleventid: int ... 2 more fields]\nwarning: there was one deprecation warning; re-run with -deprecation for details\nevents: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [globaleventid: int, date: int ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1611766400380_306382721","id":"20210114-202204_1320826212","dateCreated":"2021-01-27T16:53:20+0000","dateStarted":"2021-01-27T17:25:03+0000","dateFinished":"2021-01-27T17:25:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10621"},{"text":"// Jointure GKG MENTIONS on fait la jointure sur mentionid l'identifiant du document article\nval q1_join_mentiongkg = mentions.join(gkg, Seq(\"mentionid\"),\"inner\")\n//q1_join_mentiongkg.show(3)\n//q1_join_mentiongkg.select(q1_join_mentiongkg.columns.map(c => countDistinct(col(c)).alias(c)): _*).show // pour faire un count des valeur unique par colonne","user":"anonymous","dateUpdated":"2021-01-27T17:25:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"q1_join_mentiongkg: org.apache.spark.sql.DataFrame = [mentionid: string, globaleventid: int ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1611766400381_-1373089849","id":"20210114-204338_1479665659","dateCreated":"2021-01-27T16:53:20+0000","dateStarted":"2021-01-27T17:25:04+0000","dateFinished":"2021-01-27T17:25:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10622"},{"text":"// Jointure MENTIONS EVENTS\n\nval q1_join_eventmention = events.join(q1_join_mentiongkg, Seq(\"globaleventid\"),\"inner\")\n//q1_join_eventmention.show(3)\n//q1_join_eventmention.select(q1_join_eventmention.columns.map(c => countDistinct(col(c)).alias(c)): _*).show // pour faire un count des valeur unique par colonne","user":"anonymous","dateUpdated":"2021-01-27T17:25:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":87.45,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"q1_join_eventmention: org.apache.spark.sql.DataFrame = [globaleventid: int, date: int ... 4 more fields]\n"}]},"apps":[],"jobName":"paragraph_1611766400381_-1361867506","id":"20210114-222745_1115949304","dateCreated":"2021-01-27T16:53:20+0000","dateStarted":"2021-01-27T17:25:04+0000","dateFinished":"2021-01-27T17:25:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10623"},{"text":"// Création du dataframe correspondant à la requête attendue 1\n\nval query1 = q1_join_eventmention.\n    groupBy(\"date\",\"paysaction\",\"langue\"). // pour query 1\n    agg(countDistinct($\"globaleventid\").alias(\"num_event\"),countDistinct($\"mentionid\").alias(\"num_article\")). // calcul du nombre d'event et article\n    withColumn(\"num_event\",$\"num_event\".cast(\"Int\")). // sinon pris en long\n    withColumn(\"num_article\",$\"num_article\".cast(\"Int\")).// sinon pris en long\n    na.drop()\n\n//query1.show(100)","user":"anonymous","dateUpdated":"2021-01-27T17:25:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"query1: org.apache.spark.sql.DataFrame = [date: int, paysaction: string ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1611766400381_618406163","id":"20210114-222141_1725173263","dateCreated":"2021-01-27T16:53:20+0000","dateStarted":"2021-01-27T17:25:04+0000","dateFinished":"2021-01-27T17:25:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10624"},{"text":"//query1.select(query1.columns.map(c => countDistinct(col(c)).alias(c)): _*).show\n//query1.printSchema","user":"anonymous","dateUpdated":"2021-01-27T17:25:05+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1611766400382_-2085911134","id":"20210115-232949_1752508653","dateCreated":"2021-01-27T16:53:20+0000","dateStarted":"2021-01-27T17:25:05+0000","dateFinished":"2021-01-27T17:25:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10625"},{"text":"\nimport com.datastax.spark.connector.cql.CassandraConnector\nimport org.apache.spark.sql.cassandra._\nimport org.apache.spark.sql.SaveMode\n//import com.datastax.spark.connector.types._\n//import org.apache.spark.sql.catalyst\n//Export en parquet import de librairie","user":"anonymous","dateUpdated":"2021-01-27T17:25:05+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.datastax.spark.connector.cql.CassandraConnector\nimport org.apache.spark.sql.cassandra._\nimport org.apache.spark.sql.SaveMode\n"}]},"apps":[],"jobName":"paragraph_1611766400382_1491889656","id":"20210120-220623_695043634","dateCreated":"2021-01-27T16:53:20+0000","dateStarted":"2021-01-27T17:25:05+0000","dateFinished":"2021-01-27T17:25:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10626"},{"text":"// query1.write.mode(SaveMode.Overwrite).parquet(DIR_Parquet + \"query1.parquet\") // a ne pas décommenter une fois test ok","user":"anonymous","dateUpdated":"2021-01-27T17:25:05+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1611766400382_-1327234855","id":"20210116-204424_468738577","dateCreated":"2021-01-27T16:53:20+0000","dateStarted":"2021-01-27T17:25:06+0000","dateFinished":"2021-01-27T17:25:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10627"},{"text":"//Rechargement en parquet si option sélectionné par l'équipe\n// val query1_parquet=spark.read.parquet(DIR_Parquet + \"query1.parquet\")","user":"anonymous","dateUpdated":"2021-01-27T17:25:06+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1611766400383_-189616532","id":"20210116-221756_288502152","dateCreated":"2021-01-27T16:53:20+0000","dateStarted":"2021-01-27T17:25:06+0000","dateFinished":"2021-01-27T17:25:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10628"},{"text":"CassandraConnector(sc.getConf).withSessionDo { session =>\n// session.execute(\"DROP KEYSPACE gdelt\")\nsession.execute(\"CREATE KEYSPACE IF NOT EXISTS gdelt WITH REPLICATION = {'class': 'SimpleStrategy', 'replication_factor': 3 }\") \nsession.execute(\"CREATE TABLE IF NOT EXISTS gdelt.table_q1(date int , paysaction text, langue text, num_event int, num_article int, PRIMARY KEY (date, paysaction, langue))\")\n}","user":"anonymous","dateUpdated":"2021-01-27T17:25:06+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res232: com.datastax.driver.core.ResultSet = ResultSet[ exhausted: true, Columns[]]\n"}]},"apps":[],"jobName":"paragraph_1611766400383_573336218","id":"20210120-223949_1568041941","dateCreated":"2021-01-27T16:53:20+0000","dateStarted":"2021-01-27T17:25:06+0000","dateFinished":"2021-01-27T17:25:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10629"},{"text":"// Export du dataframe dans la table Cassandra choisir si usage parquet ou non\n\nquery1.write.cassandraFormat(\"table_q1\",\"gdelt\").mode(SaveMode.Append).save() //\n//query1_parquet.write.cassandraFormat(\"table_q1\",\"gdelt\").mode(SaveMode.Append).save() // si utilisation backup parquet","user":"anonymous","dateUpdated":"2021-01-27T17:25:06+0000","config":{"lineNumbers":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{"0":{"graph":{"mode":"table","height":354,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1611766400383_996351279","id":"20210115-234227_361986203","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10630","dateFinished":"2021-01-27T17:28:13+0000","dateStarted":"2021-01-27T17:25:06+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-20-125.ec2.internal:4040/jobs/job?id=21"],"interpreterSettingId":"spark"}}},{"text":"val reload_query1 = spark.read.\n      cassandraFormat(\"table_q1\", \"gdelt\").\n      load()\n\n// reload_query1.count\n\nreload_query1.createOrReplaceTempView(\"vue_q1\")","user":"anonymous","dateUpdated":"2021-01-27T17:28:13+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"reload_query1: org.apache.spark.sql.DataFrame = [date: int, paysaction: string ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1611766400384_-1230584048","id":"20210116-193839_1388787024","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10631","dateFinished":"2021-01-27T17:28:13+0000","dateStarted":"2021-01-27T17:28:13+0000"},{"text":"// reload_query1.show()","user":"anonymous","dateUpdated":"2021-01-27T17:28:13+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1611766400384_1291196624","id":"20210119-222957_1409718940","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10632","dateFinished":"2021-01-27T17:28:13+0000","dateStarted":"2021-01-27T17:28:13+0000"},{"text":"z.show(spark.sql(\"\"\"SELECT  num_event,num_article,paysaction \n                    FROM vue_q1 \n                    WHERE date=\"20200401\" \n                    AND langue=\"eng\"\n                                        \"\"\"))","user":"anonymous","dateUpdated":"2021-01-27T17:28:13+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"num_event":"string","num_article":"string","paysaction":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"pieChart":{},"scatterChart":{"xAxis":{"name":"paysaction","index":2,"aggr":"sum"},"yAxis":{"name":"num_article","index":1,"aggr":"sum"},"size":{"name":"num_event","index":0,"aggr":"sum"}}},"keys":[{"name":"paysaction","index":2,"aggr":"sum"}],"groups":[],"values":[{"name":"num_article","index":1,"aggr":"sum"}],"commonSetting":{}},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"num_event\tnum_article\tpaysaction\n21\t4\tAE\n6\t1\tAF\n7\t1\tAG\n9\t2\tAM\n10\t7\tAR\n205\t88\tAS\n5\t2\tAU\n2\t1\tBD\n5\t5\tBE\n10\t3\tBG\n24\t19\tBR\n4\t2\tBU\n137\t45\tCA\n4\t1\tCE\n192\t78\tCH\n4\t1\tCI\n1\t1\tCO\n3\t1\tCU\n10\t4\tEG\n18\t5\tEI\n5\t1\tET\n2\t1\tEZ\n43\t16\tFR\n22\t5\tGH\n31\t10\tGM\n37\t9\tGQ\n7\t3\tGR\n2\t1\tGT\n4\t7\tHK\n7\t3\tHU\n58\t11\tID\n121\t24\tIN\n52\t12\tIR\n19\t8\tIS\n45\t18\tIT\n1\t1\tIV\n37\t4\tIZ\n21\t9\tJA\n7\t3\tJE\n2\t1\tJM\n3\t1\tJO\n18\t7\tKE\n1\t1\tKN\n16\t10\tKS\n6\t4\tKU\n13\t3\tLY\n10\t1\tMA\n2\t1\tMN\n6\t2\tMO\n17\t1\tMT\n23\t11\tMX\n40\t5\tMY\n3\t2\tMZ\n66\t12\tNI\n5\t2\tNL\n12\t2\tNO\n4\t1\tNP\n6\t1\tNU\n41\t9\tNZ\n4\t2\tPA\n3\t2\tPE\n69\t11\tPK\n8\t4\tPL\n2\t1\tPM\n1\t1\tPO\n5\t1\tQA\n2\t1\tRI\n1\t1\tRO\n47\t8\tRP\n10\t2\tRQ\n56\t17\tRS\n20\t11\tSA\n11\t6\tSF\n2\t1\tSG\n4\t2\tSL\n6\t4\tSN\n26\t2\tSO\n26\t12\tSP\n4\t1\tSU\n4\t2\tSW\n3\t1\tSY\n7\t3\tSZ\n3\t2\tTD\n21\t7\tTH\n2\t2\tTS\n17\t5\tTU\n22\t5\tTW\n6\t2\tTX\n127\t51\tUK\n2240\t618\tUS\n9\t2\tUY\n15\t2\tVE\n6\t4\tVM\n4\t1\tWA\n4\t1\tZI\n"}]},"apps":[],"jobName":"paragraph_1611766400384_-197960884","id":"20210116-195448_421797379","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10633","dateFinished":"2021-01-27T17:28:14+0000","dateStarted":"2021-01-27T17:28:13+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-20-125.ec2.internal:4040/jobs/job?id=22"],"interpreterSettingId":"spark"}}},{"text":"%md\n# Query 2 \n## Pour un pays donné en paramètre, affichez les évènements qui y ont eu place triées par le nombre de mentions (tri décroissant); permettez une agrégation par jour/mois/année","user":"anonymous","dateUpdated":"2021-01-27T17:28:14+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Query 2</h1>\n<h2>Pour un pays donné en paramètre, affichez les évènements qui y ont eu place triées par le nombre de mentions (tri décroissant); permettez une agrégation par jour/mois/année</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1611766400385_556216504","id":"20210116-221225_2079436676","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10634","dateFinished":"2021-01-27T17:28:14+0000","dateStarted":"2021-01-27T17:28:14+0000"},{"text":"%md\n#### les datframes gkg et mention sont identiques.","user":"anonymous","dateUpdated":"2021-01-27T17:28:14+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>les datframes gkg et mention sont identiques.</h4>\n</div>"}]},"apps":[],"jobName":"paragraph_1611766400385_-1377146646","id":"20210117-121304_1054138952","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10635","dateFinished":"2021-01-27T17:28:14+0000","dateStarted":"2021-01-27T17:28:14+0000"},{"text":"val query2_raw = q1_join_eventmention.\nwithColumn(\"mois\",$\"date\".substr(5,2)).\nwithColumn(\"annee\",$\"date\".substr(0,4)).\nwithColumn(\"jour\",$\"date\".substr(7,2)) \n\n//query2_raw.show()","user":"anonymous","dateUpdated":"2021-01-27T17:28:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"query2_raw: org.apache.spark.sql.DataFrame = [globaleventid: int, date: int ... 7 more fields]\n"}]},"apps":[],"jobName":"paragraph_1611766400385_1889930120","id":"20210124-132804_57154767","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10636","dateFinished":"2021-01-27T17:28:15+0000","dateStarted":"2021-01-27T17:28:14+0000"},{"text":"val query2 = query2_raw.\n    groupBy(\"paysaction\",\"globaleventid\",\"annee\",\"mois\",\"jour\"). \n    agg(count($\"mentionid\").alias(\"num_article\")).\n    na.drop()\n\n//query2.show(4)","user":"anonymous","dateUpdated":"2021-01-27T17:28:15+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"query2: org.apache.spark.sql.DataFrame = [paysaction: string, globaleventid: int ... 4 more fields]\n"}]},"apps":[],"jobName":"paragraph_1611766400385_238993130","id":"20210116-224655_1361579703","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10637","dateFinished":"2021-01-27T17:28:15+0000","dateStarted":"2021-01-27T17:28:15+0000"},{"text":"//Export en parquet\n// query2.write.mode(SaveMode.Overwrite).parquet(DIR_Parquet + \"query2.parquet\") ","user":"anonymous","dateUpdated":"2021-01-27T17:28:15+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1611766400386_2111912462","id":"20210118-175702_196792973","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10638","dateFinished":"2021-01-27T17:28:15+0000","dateStarted":"2021-01-27T17:28:15+0000"},{"text":"//Rechargement en parquet si option sélectionné par l'équipe\n// val query2_parquet=spark.read.parquet(DIR_Parquet + \"query2.parquet\")","user":"anonymous","dateUpdated":"2021-01-27T17:28:15+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1611766400386_1105396077","id":"20210120-232929_1360726099","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10639","dateFinished":"2021-01-27T17:28:15+0000","dateStarted":"2021-01-27T17:28:15+0000"},{"text":"CassandraConnector(sc.getConf).withSessionDo { session =>\n// session.execute(\"DROP KEYSPACE gdelt\")\n// session.execute(\"DROP TABLE gdelt.table_q2\")\nsession.execute(\"CREATE KEYSPACE IF NOT EXISTS gdelt WITH REPLICATION = {'class': 'SimpleStrategy', 'replication_factor': 3 }\") \nsession.execute(\"CREATE TABLE IF NOT EXISTS gdelt.table_q2(globaleventid int , paysaction text,  annee int, mois int, jour int, num_article int,  PRIMARY KEY (paysaction, annee , mois , jour ,globaleventid))\")\n}\n\n//query2_parquet.write.cassandraFormat(\"table_q2\",\"gdelt\").mode(SaveMode.Append).save()\nquery2.write.cassandraFormat(\"table_q2\",\"gdelt\").mode(SaveMode.Append).save()\n","user":"anonymous","dateUpdated":"2021-01-27T17:28:15+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res255: com.datastax.driver.core.ResultSet = ResultSet[ exhausted: true, Columns[]]\n"}]},"apps":[],"jobName":"paragraph_1611766400386_-1013650780","id":"20210118-171545_1996795651","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10640","dateFinished":"2021-01-27T17:28:46+0000","dateStarted":"2021-01-27T17:28:15+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-20-125.ec2.internal:4040/jobs/job?id=23"],"interpreterSettingId":"spark"}}},{"text":"val reload_query2 = spark.read.\n      cassandraFormat(\"table_q2\", \"gdelt\").\n      load()\n      \n// reload_query2.count\n      \nreload_query2.createOrReplaceTempView(\"vue_q2\")","user":"anonymous","dateUpdated":"2021-01-27T17:28:46+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"reload_query2: org.apache.spark.sql.DataFrame = [paysaction: string, annee: int ... 4 more fields]\n"}]},"apps":[],"jobName":"paragraph_1611766400387_1203457577","id":"20210118-190411_1248160926","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10641","dateFinished":"2021-01-27T17:28:46+0000","dateStarted":"2021-01-27T17:28:46+0000"},{"text":"z.show(spark.sql(\"\"\"SELECT paysaction ,globaleventid ,annee, mois,jour ,num_article \n                    FROM vue_q2\n                    WHERE paysaction=\"FR\"\n                    ORDER BY num_article DESC \n                                        \"\"\"))","user":"anonymous","dateUpdated":"2021-01-27T17:28:46+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"paysaction":"string","globaleventid":"string","annee":"string","mois":"string","jour":"string","num_article":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"paysaction","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"globaleventid","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"paysaction\tglobaleventid\tannee\tmois\tjour\tnum_article\nFR\t915710262\t2020\t4\t1\t4\nFR\t915706953\t2020\t4\t1\t2\nFR\t915706932\t2020\t4\t1\t2\nFR\t915707456\t2020\t4\t1\t2\nFR\t915715844\t2020\t4\t1\t2\nFR\t915706136\t2020\t4\t1\t1\nFR\t915706929\t2020\t4\t1\t1\nFR\t915706928\t2020\t4\t1\t1\nFR\t915706948\t2020\t4\t1\t1\nFR\t915706949\t2020\t4\t1\t1\nFR\t915708279\t2020\t4\t1\t1\nFR\t915708326\t2020\t4\t1\t1\nFR\t915708339\t2020\t4\t1\t1\nFR\t915708702\t2020\t4\t1\t1\nFR\t915708711\t2020\t4\t1\t1\nFR\t915706956\t2020\t4\t1\t1\nFR\t915708860\t2020\t4\t1\t1\nFR\t915708305\t2020\t4\t1\t1\nFR\t915708883\t2020\t4\t1\t1\nFR\t915708338\t2020\t4\t1\t1\nFR\t915709196\t2020\t4\t1\t1\nFR\t915708341\t2020\t4\t1\t1\nFR\t915709996\t2020\t4\t1\t1\nFR\t915708707\t2020\t4\t1\t1\nFR\t915710264\t2020\t4\t1\t1\nFR\t915708799\t2020\t4\t1\t1\nFR\t915708855\t2020\t4\t1\t1\nFR\t915708859\t2020\t4\t1\t1\nFR\t915711338\t2020\t4\t1\t1\nFR\t915708870\t2020\t4\t1\t1\nFR\t915708871\t2020\t4\t1\t1\nFR\t915708882\t2020\t4\t1\t1\nFR\t915712665\t2020\t4\t1\t1\nFR\t915709100\t2020\t4\t1\t1\nFR\t915709136\t2020\t4\t1\t1\nFR\t915709155\t2020\t4\t1\t1\nFR\t915714898\t2020\t4\t1\t1\nFR\t915709277\t2020\t4\t1\t1\nFR\t915709511\t2020\t4\t1\t1\nFR\t915709940\t2020\t4\t1\t1\nFR\t915715316\t2020\t4\t1\t1\nFR\t915710074\t2020\t4\t1\t1\nFR\t915710080\t2020\t4\t1\t1\nFR\t915710154\t2020\t4\t1\t1\nFR\t915715847\t2020\t4\t1\t1\nFR\t915710265\t2020\t4\t1\t1\nFR\t915710266\t2020\t4\t1\t1\nFR\t915710301\t2020\t4\t1\t1\nFR\t915710391\t2020\t4\t1\t1\nFR\t915711161\t2020\t4\t1\t1\nFR\t915711221\t2020\t4\t1\t1\nFR\t915711312\t2020\t4\t1\t1\nFR\t915712509\t2020\t4\t1\t1\nFR\t915712510\t2020\t4\t1\t1\nFR\t915712515\t2020\t4\t1\t1\nFR\t915712563\t2020\t4\t1\t1\nFR\t915712564\t2020\t4\t1\t1\nFR\t915712614\t2020\t4\t1\t1\nFR\t915712643\t2020\t4\t1\t1\nFR\t915712734\t2020\t4\t1\t1\nFR\t915712786\t2020\t4\t1\t1\nFR\t915713117\t2020\t4\t1\t1\nFR\t915713524\t2020\t4\t1\t1\nFR\t915714332\t2020\t4\t1\t1\nFR\t915714840\t2020\t4\t1\t1\nFR\t915714841\t2020\t4\t1\t1\nFR\t915714996\t2020\t4\t1\t1\nFR\t915715001\t2020\t4\t1\t1\nFR\t915715033\t2020\t4\t1\t1\nFR\t915715265\t2020\t4\t1\t1\nFR\t915715267\t2020\t4\t1\t1\nFR\t915715268\t2020\t4\t1\t1\nFR\t915715298\t2020\t4\t1\t1\nFR\t915715351\t2020\t4\t1\t1\nFR\t915715352\t2020\t4\t1\t1\nFR\t915715380\t2020\t4\t1\t1\nFR\t915715408\t2020\t4\t1\t1\nFR\t915715574\t2020\t4\t1\t1\nFR\t915715721\t2020\t4\t1\t1\nFR\t915715845\t2020\t4\t1\t1\nFR\t915715908\t2020\t4\t1\t1\n"}]},"apps":[],"jobName":"paragraph_1611766400387_-1429985007","id":"20210118-192747_1520267025","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10642","dateFinished":"2021-01-27T17:28:47+0000","dateStarted":"2021-01-27T17:28:46+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-20-125.ec2.internal:4040/jobs/job?id=24"],"interpreterSettingId":"spark"}}},{"text":"%md\n# Query 3\n## Pour une source de donnés passée en paramètre (gkg.SourceCommonName) affichez les thèmes, personnes, lieux dont les articles de cette source parlent ainsi que le le nombre d’articles et le ton moyen des articles (pour chaque thème/personne/lieu); permettez une agrégation par jour/mois/année.","user":"anonymous","dateUpdated":"2021-01-27T17:28:47+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Query 3</h1>\n<h2>Pour une source de donnés passée en paramètre (gkg.SourceCommonName) affichez les thèmes, personnes, lieux dont les articles de cette source parlent ainsi que le le nombre d’articles et le ton moyen des articles (pour chaque thème/personne/lieu); permettez une agrégation par jour/mois/année.</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1611766400387_416296657","id":"20210116-230341_1214303457","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10643","dateFinished":"2021-01-27T17:28:47+0000","dateStarted":"2021-01-27T17:28:47+0000"},{"text":"%md\n## Classement par sélection sur thème","user":"anonymous","dateUpdated":"2021-01-27T17:28:47+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Classement par sélection sur thème</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1611766400388_1286136512","id":"20210120-234529_1159766909","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10644","dateFinished":"2021-01-27T17:28:47+0000","dateStarted":"2021-01-27T17:28:47+0000"},{"text":"val gkg_q3_theme= gkg_all.select(\"mentionid\", \"sourcecommonname\", \"theme\", \"tone\", \"dategkg\").\nfilter(!($\"sourcecommonname\".isNaN || $\"sourcecommonname\".isNull || $\"sourcecommonname\" === \"\")).\nwithColumn(\"theme\", explode(split($\"theme\", \";\"))).\nfilter(!($\"theme\".isNaN || $\"theme\".isNull || $\"theme\" === \"\")).\nwithColumn(\"tone\", substring_index($\"tone\", \",\", 1)).\nwithColumn(\"annee\", substring($\"dategkg\", 0, 4)).\nwithColumn(\"mois\", substring($\"dategkg\", 5, 2)).\nwithColumn(\"jour\", substring($\"dategkg\", 7, 2)).\ngroupBy(\"sourcecommonname\", \"annee\", \"mois\", \"jour\", \"theme\").  \nagg(count($\"mentionid\").alias(\"num_article\"),mean($\"tone\").alias(\"avg_tone\")).\nna.drop()\n\n\n\n// gkg_q3_theme.write.mode(SaveMode.Overwrite).parquet(DIR_Parquet + \"gkg_q3_theme.parquet\") // backup en parquet\n// val gkg_q3_theme_parquet = spark.read.parquet(DIR_Parquet + \"gkg_q3_theme.parquet\") // rechargement parquet backup","user":"anonymous","dateUpdated":"2021-01-27T17:28:47+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"gkg_q3_theme: org.apache.spark.sql.DataFrame = [sourcecommonname: string, annee: string ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1611766400388_1377632739","id":"20210116-230345_527513356","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10645","dateFinished":"2021-01-27T17:28:48+0000","dateStarted":"2021-01-27T17:28:47+0000"},{"text":"CassandraConnector(sc.getConf).withSessionDo { session =>\n//session.execute(\"DROP KEYSPACE gdelt\")\n// session.execute(\"DROP TABLE gdelt.table_q3_theme\")\nsession.execute(\"CREATE KEYSPACE IF NOT EXISTS gdelt WITH REPLICATION = {'class': 'SimpleStrategy', 'replication_factor': 3 }\")\nsession.execute(\"CREATE TABLE IF NOT EXISTS gdelt.table_q3_theme(sourcecommonname text, annee int, mois int, jour int, theme text, num_article int, avg_tone double, PRIMARY KEY (sourcecommonname, annee, mois, jour, theme))\")\n}\n\n//gkg_q3_theme_parquet.write.cassandraFormat(\"table_q3_theme\",\"gdelt\").mode(SaveMode.Append).save()\ngkg_q3_theme.write.cassandraFormat(\"table_q3_theme\",\"gdelt\").mode(SaveMode.Append).save()","user":"anonymous","dateUpdated":"2021-01-27T17:28:48+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res267: com.datastax.driver.core.ResultSet = ResultSet[ exhausted: true, Columns[]]\n"}]},"apps":[],"jobName":"paragraph_1611766400388_281441874","id":"20210120-230942_1846085557","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10646","dateFinished":"2021-01-27T17:29:22+0000","dateStarted":"2021-01-27T17:28:48+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-20-125.ec2.internal:4040/jobs/job?id=25"],"interpreterSettingId":"spark"}}},{"text":"val reload_q3_theme = spark.read.\n      cassandraFormat(\"table_q3_theme\",\"gdelt\").\n      load()\n      \n// reload_q3_theme.count\n      \nreload_q3_theme.createOrReplaceTempView(\"vue_q3_theme\")\n","user":"anonymous","dateUpdated":"2021-01-27T17:29:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"reload_q3_theme: org.apache.spark.sql.DataFrame = [sourcecommonname: string, annee: int ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1611766400388_1895261198","id":"20210118-194553_1700439984","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10647","dateFinished":"2021-01-27T17:29:22+0000","dateStarted":"2021-01-27T17:29:22+0000"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"sourcecommonname":"string","annee":"string","mois":"string","jour":"string","theme":"string","avg_tone":"string","num_article":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611767500508_-1863543676","id":"20210127-171140_1122542787","dateCreated":"2021-01-27T17:11:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:17858","text":"z.show(spark.sql(\"\"\"SELECT * FROM vue_q3_theme                  \n    WHERE sourcecommonname like 'billboard.com'\n    ORDER BY num_article DESC\n\"\"\"))","dateUpdated":"2021-01-27T17:29:22+0000","dateFinished":"2021-01-27T17:29:26+0000","dateStarted":"2021-01-27T17:29:23+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"sourcecommonname\tannee\tmois\tjour\ttheme\tavg_tone\tnum_article\nbillboard.com\t2020\t4\t1\tungp_healthcare\t-1.0897972557484679\t3\nbillboard.com\t2020\t4\t1\tgeneral_health\t-1.0897972557484679\t3\nbillboard.com\t2020\t4\t1\ttax_disease\t-1.0897972557484679\t3\nbillboard.com\t2020\t4\t1\twb_2165_health_emergencies\t-1.0897972557484679\t3\nbillboard.com\t2020\t4\t1\twb_2166_health_emergency_preparedness_and_disaster_response\t-1.0897972557484679\t3\nbillboard.com\t2020\t4\t1\thealth_pandemic\t-1.0897972557484679\t3\nbillboard.com\t2020\t4\t1\ttax_disease_coronavirus\t-1.0897972557484679\t3\nbillboard.com\t2020\t4\t1\twb_2167_pandemics\t-1.0897972557484679\t3\nbillboard.com\t2020\t4\t1\twb_621_health_nutrition_and_population\t-1.0897972557484679\t3\nbillboard.com\t2020\t4\t1\ttax_fncact\t-1.0897972557484679\t3\nbillboard.com\t2020\t4\t1\twb_635_public_health\t-1.0897972557484679\t3\nbillboard.com\t2020\t4\t1\tsoc_quarantine\t-2.155755371247537\t2\nbillboard.com\t2020\t4\t1\ttax_fncact_artists\t0.3915258088683585\t2\nbillboard.com\t2020\t4\t1\twb_1324_emergency_medical_services\t-2.155755371247537\t2\nbillboard.com\t2020\t4\t1\tmedia_social\t-2.155755371247537\t2\nbillboard.com\t2020\t4\t1\tcrisislex_c03_wellbeing_health\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\tcrisislex_c07_safety\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\tmedia_msm\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\tcrisislex_crisislexrec\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\tepu_cats_healthcare\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\tmedical\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\tsoc_pointsofinterest_hospitals\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\ttax_fncact_doctor\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\tcrisislex_t03_dead\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\tepu_policy\t-0.259067357512953\t1\nbillboard.com\t2020\t4\t1\tepu_policy_spending\t-0.259067357512953\t1\nbillboard.com\t2020\t4\t1\tsoc_pointsofinterest\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\ttax_disease_disease\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\ttax_disease_flu\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\ttax_fncact_doctors\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\ttax_fncact_father\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\ttax_fncact_musician\t-0.259067357512953\t1\nbillboard.com\t2020\t4\t1\ttax_fncact_official\t-0.259067357512953\t1\nbillboard.com\t2020\t4\t1\ttax_worldlanguages\t1.04211897524967\t1\nbillboard.com\t2020\t4\t1\tungp_forests_rivers_oceans\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\twb_133_information_and_communication_technologies\t-0.259067357512953\t1\nbillboard.com\t2020\t4\t1\tkill\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\tsoc_pointsofinterest_hospital\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\ttax_disease_outbreak\t1.04211897524967\t1\nbillboard.com\t2020\t4\t1\ttax_fncact_lady\t-0.259067357512953\t1\nbillboard.com\t2020\t4\t1\ttax_fncact_nurse\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\ttax_fncact_singer\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\ttax_worldlanguages_latin\t1.04211897524967\t1\nbillboard.com\t2020\t4\t1\tuspec_policy1\t-0.259067357512953\t1\nbillboard.com\t2020\t4\t1\twb_1406_diseases\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\twb_678_digital_government\t-0.259067357512953\t1\nbillboard.com\t2020\t4\t1\twb_694_broadcast_and_media\t-0.259067357512953\t1\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-20-125.ec2.internal:4040/jobs/job?id=26"],"interpreterSettingId":"spark"}}},{"text":"val gkg_q3_person = gkg_all.\n    select(\"mentionid\", \"sourcecommonname\", \"persons\", \"tone\", \"dategkg\").\n    filter(!($\"sourcecommonname\".isNaN || $\"sourcecommonname\".isNull || $\"sourcecommonname\" === \"\")).\n    withColumn(\"person\", explode(split($\"persons\", \";\"))).\n    filter(!($\"person\".isNaN || $\"person\".isNull || $\"person\" === \"\")).\n    withColumn(\"tone\", substring_index($\"tone\", \",\", 1)).\n    withColumn(\"annee\", substring($\"dategkg\", 0, 4)).\n    withColumn(\"mois\", substring($\"dategkg\", 5, 2)).\n    withColumn(\"jour\", substring($\"dategkg\", 7, 2)).\n    groupBy(\"sourcecommonname\", \"annee\", \"mois\", \"jour\",\"person\").  \n    agg(count($\"mentionid\").alias(\"num_article\"),     \n        mean($\"tone\").alias(\"avg_tone\")).\n    na.drop()\n        \n// gkg_q3_person.write.mode(SaveMode.Overwrite).parquet(DIR_Parquet + \"gkg_q3_person.parquet\") // backup en parquet\n// val gkg_q3_person_parquet = spark.read.parquet(DIR_Parquet + \"gkg_q3_person.parquet\") // rechargement parquet backup","user":"anonymous","dateUpdated":"2021-01-27T17:29:26+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"gkg_q3_person: org.apache.spark.sql.DataFrame = [sourcecommonname: string, annee: string ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1611766400389_-944742127","id":"20210116-232016_116242793","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10648","dateFinished":"2021-01-27T17:29:26+0000","dateStarted":"2021-01-27T17:29:26+0000"},{"text":"CassandraConnector(sc.getConf).withSessionDo { session =>\n//session.execute(\"DROP KEYSPACE gdelt\")\n// session.execute(\"DROP TABLE gdelt.table_q3_person\")\nsession.execute(\"CREATE KEYSPACE IF NOT EXISTS gdelt WITH REPLICATION = {'class': 'SimpleStrategy', 'replication_factor': 3 }\")\nsession.execute(\"CREATE TABLE IF NOT EXISTS gdelt.table_q3_person(sourcecommonname text, annee int, mois int, jour int, person text, num_article int, avg_tone double, PRIMARY KEY (sourcecommonname, annee, mois,jour,person))\")\n}\n\n//gkg_q3_person_parquet.write.cassandraFormat(\"table_q3_person\",\"gdelt\").mode(SaveMode.Append).save()\ngkg_q3_person.write.cassandraFormat(\"table_q3_person\",\"gdelt\").mode(SaveMode.Append).save()\n","user":"anonymous","dateUpdated":"2021-01-27T17:29:27+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res279: com.datastax.driver.core.ResultSet = ResultSet[ exhausted: true, Columns[]]\n"}]},"apps":[],"jobName":"paragraph_1611766400389_1117090199","id":"20210120-230944_1273534319","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10649","dateFinished":"2021-01-27T17:29:47+0000","dateStarted":"2021-01-27T17:29:27+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-20-125.ec2.internal:4040/jobs/job?id=27"],"interpreterSettingId":"spark"}}},{"text":"val reload_q3_person = spark.read.\n      cassandraFormat(\"table_q3_person\",\"gdelt\").\n      load()\n      \n// reload_q3_person.count\n      \nreload_q3_person.createOrReplaceTempView(\"vue_q3_person\")","user":"anonymous","dateUpdated":"2021-01-27T17:29:47+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"reload_q3_person: org.apache.spark.sql.DataFrame = [sourcecommonname: string, annee: int ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1611766400389_857083485","id":"20210124-145426_979692154","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10650","dateFinished":"2021-01-27T17:29:47+0000","dateStarted":"2021-01-27T17:29:47+0000"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"sourcecommonname":"string","annee":"string","mois":"string","jour":"string","person":"string","avg_tone":"string","num_article":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611767717210_-1485795657","id":"20210127-171517_1759308036","dateCreated":"2021-01-27T17:15:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19412","text":"z.show(spark.sql(\"\"\"SELECT * FROM vue_q3_person                  \n    WHERE sourcecommonname like 'billboard.com'\n    ORDER BY num_article DESC\n\"\"\"))","dateUpdated":"2021-01-27T17:29:47+0000","dateFinished":"2021-01-27T17:29:47+0000","dateStarted":"2021-01-27T17:29:47+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"sourcecommonname\tannee\tmois\tjour\tperson\tavg_tone\tnum_article\nbillboard.com\t2020\t4\t1\talan merrill\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\tamor prohibido\t1.04211897524967\t1\nbillboard.com\t2020\t4\t1\tbob dylan\t-0.259067357512953\t1\nbillboard.com\t2020\t4\t1\tbush machinehead\t-0.259067357512953\t1\nbillboard.com\t2020\t4\t1\telvis crespo\t1.04211897524967\t1\nbillboard.com\t2020\t4\t1\tgavin rossdale\t-0.259067357512953\t1\nbillboard.com\t2020\t4\t1\tgloria trevi\t1.04211897524967\t1\nbillboard.com\t2020\t4\t1\tjoanna lisanti\t-4.05244338498212\t1\nbillboard.com\t2020\t4\t1\tmanny cruz\t1.04211897524967\t1\nbillboard.com\t2020\t4\t1\tmonica naranjo\t1.04211897524967\t1\nbillboard.com\t2020\t4\t1\tricky martin\t1.04211897524967\t1\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-20-125.ec2.internal:4040/jobs/job?id=28"],"interpreterSettingId":"spark"}}},{"text":"val gkg_q3_location = gkg_all.\n    select(\"mentionid\", \"sourcecommonname\", \"locations\", \"tone\", \"dategkg\").\n    filter(!($\"sourcecommonname\".isNaN || $\"sourcecommonname\".isNull || $\"sourcecommonname\" === \"\")).\n    withColumn(\"locations\", explode(split($\"locations\", \";\"))).\n    filter(!($\"locations\".isNaN || $\"locations\".isNull || $\"locations\" === \"\")).\n    withColumn(\"locationpays\", split($\"locations\", \"#\").getItem(1)).\n    withColumn(\"tone\", substring_index($\"tone\", \",\", 1)).\n    withColumn(\"annee\", substring($\"dategkg\", 0, 4)).\n    withColumn(\"mois\", substring($\"dategkg\", 5, 2)).\n    withColumn(\"jour\", substring($\"dategkg\", 7, 2)).\n    groupBy(\"sourcecommonname\", \"annee\", \"mois\", \"jour\",\"locationpays\").   \n    agg(count($\"mentionid\").alias(\"num_article\"),     \n        mean($\"tone\").alias(\"avg_tone\")).\n        na.drop()\n        \n// gkg_q3_location.write.mode(SaveMode.Overwrite).parquet(DIR_Parquet + \"gkg_q3_location.parquet\") // backup en parquet\n// val gkg_q3_location_parquet = spark.read.parquet(DIR_Parquet + \"gkg_q3_location.parquet\") // rechargement parquet backup","user":"anonymous","dateUpdated":"2021-01-27T17:29:48+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"gkg_q3_location: org.apache.spark.sql.DataFrame = [sourcecommonname: string, annee: string ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1611766400389_-841517396","id":"20210116-232425_1200890152","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10651","dateFinished":"2021-01-27T17:29:48+0000","dateStarted":"2021-01-27T17:29:48+0000"},{"text":"CassandraConnector(sc.getConf).withSessionDo { session =>\n//session.execute(\"DROP KEYSPACE gdelt\")\n// session.execute(\"DROP TABLE gdelt.table_q3_lieu\")\nsession.execute(\"CREATE KEYSPACE IF NOT EXISTS gdelt WITH REPLICATION = {'class': 'SimpleStrategy', 'replication_factor': 3 }\")\nsession.execute(\"CREATE TABLE IF NOT EXISTS gdelt.table_q3_lieu(sourcecommonname text, annee int, mois int, jour int, locationpays text, num_article int, avg_tone double,PRIMARY KEY (sourcecommonname, annee, mois, jour,locationpays))\")\n}\n\n// gkg_q3_location_parquet.write.cassandraFormat(\"table_q3_lieu\",\"gdelt\").mode(SaveMode.Append).save()\ngkg_q3_location.write.cassandraFormat(\"table_q3_lieu\",\"gdelt\").mode(SaveMode.Append).save()","user":"anonymous","dateUpdated":"2021-01-27T17:29:48+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res291: com.datastax.driver.core.ResultSet = ResultSet[ exhausted: true, Columns[]]\n"}]},"apps":[],"jobName":"paragraph_1611766400390_984361505","id":"20210116-233553_320548416","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10652","dateFinished":"2021-01-27T17:30:10+0000","dateStarted":"2021-01-27T17:29:48+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-20-125.ec2.internal:4040/jobs/job?id=29"],"interpreterSettingId":"spark"}}},{"text":"val reload_query3_lieu = spark.read.\n      cassandraFormat(\"table_q3_lieu\",\"gdelt\").\n      load()\n      \n// reload_query3_lieu.count\n      \nreload_query3_lieu.createOrReplaceTempView(\"vue_q3_lieu\")\n","user":"anonymous","dateUpdated":"2021-01-27T17:30:10+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"reload_query3_lieu: org.apache.spark.sql.DataFrame = [sourcecommonname: string, annee: int ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1611766400390_-1117205311","id":"20210118-200244_1223186144","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10653","dateFinished":"2021-01-27T17:30:10+0000","dateStarted":"2021-01-27T17:30:10+0000"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"sourcecommonname":"string","annee":"string","mois":"string","jour":"string","locationpays":"string","avg_tone":"string","num_article":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"sourcecommonname","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"annee","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611767790640_98972767","id":"20210127-171630_1475425351","dateCreated":"2021-01-27T17:16:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20858","text":"z.show(spark.sql(\"\"\"SELECT * FROM vue_q3_lieu                  \n    WHERE sourcecommonname like 'yahoo.com'\n    ORDER BY num_article DESC\n\"\"\"))","dateUpdated":"2021-01-27T17:30:10+0000","dateFinished":"2021-01-27T17:30:11+0000","dateStarted":"2021-01-27T17:30:10+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"sourcecommonname\tannee\tmois\tjour\tlocationpays\tavg_tone\tnum_article\nyahoo.com\t2020\t4\t1\tUnited States\t-2.8719911739497186\t21\nyahoo.com\t2020\t4\t1\tChina\t-2.5059194106324045\t11\nyahoo.com\t2020\t4\t1\tNew York, United States\t-1.6937729704771172\t10\nyahoo.com\t2020\t4\t1\tRussia\t-3.017257596722589\t7\nyahoo.com\t2020\t4\t1\tAustralia\t-2.8895364719125\t7\nyahoo.com\t2020\t4\t1\tIndia\t-0.9001544612283832\t6\nyahoo.com\t2020\t4\t1\tWhite House, District Of Columbia, United States\t-4.571144721950823\t6\nyahoo.com\t2020\t4\t1\tJapan\t-3.885918144640062\t5\nyahoo.com\t2020\t4\t1\tWashington, Washington, United States\t-2.3427380942921805\t5\nyahoo.com\t2020\t4\t1\tSaudi Arabia\t-3.81065711399365\t4\nyahoo.com\t2020\t4\t1\tHong Kong\t-0.82504124052115\t4\nyahoo.com\t2020\t4\t1\tPennsylvania, United States\t-2.869433948495993\t3\nyahoo.com\t2020\t4\t1\tTokyo, Tokyo, Japan\t-5.66277061375101\t3\nyahoo.com\t2020\t4\t1\tIndonesia\t-1.5247876828430522\t3\nyahoo.com\t2020\t4\t1\tItaly\t-2.591120253341654\t3\nyahoo.com\t2020\t4\t1\tLouisiana, United States\t-3.6254297774845234\t3\nyahoo.com\t2020\t4\t1\tFrance\t0.43483333769689664\t3\nyahoo.com\t2020\t4\t1\tTexas, United States\t-5.512300621789675\t2\nyahoo.com\t2020\t4\t1\tBaton Rouge, Louisiana, United States\t-4.331587289177605\t2\nyahoo.com\t2020\t4\t1\tOhio, United States\t-2.518436637029705\t2\nyahoo.com\t2020\t4\t1\tSingapore\t-3.3980344582506197\t2\nyahoo.com\t2020\t4\t1\tSpain\t-1.443071357456091\t2\nyahoo.com\t2020\t4\t1\tThailand\t-1.4343030594458135\t2\nyahoo.com\t2020\t4\t1\tUkraine\t-5.43192306033553\t2\nyahoo.com\t2020\t4\t1\tUnited Kingdom\t0.24313980284864395\t2\nyahoo.com\t2020\t4\t1\tBuenos Aires, Distrito Federal, Argentina\t-3.2308499826898798\t2\nyahoo.com\t2020\t4\t1\tWashington, United States\t-1.3869312088248809\t2\nyahoo.com\t2020\t4\t1\tBeijing, Beijing, China\t0.052795983776465105\t2\nyahoo.com\t2020\t4\t1\tBerlin, Berlin, Germany\t0.34824761798629295\t2\nyahoo.com\t2020\t4\t1\tCalifornia, United States\t-2.518436637029705\t2\nyahoo.com\t2020\t4\t1\tCanada\t-0.827814569536425\t2\nyahoo.com\t2020\t4\t1\tCincinnati, Ohio, United States\t0.4617824102550201\t2\nyahoo.com\t2020\t4\t1\tChile\t-3.2308499826898798\t2\nyahoo.com\t2020\t4\t1\tFlorida, United States\t-3.2308499826898798\t2\nyahoo.com\t2020\t4\t1\tFort Lauderdale, Florida, United States\t-3.2308499826898798\t2\nyahoo.com\t2020\t4\t1\tGermany\t0.34824761798629295\t2\nyahoo.com\t2020\t4\t1\tIran\t-0.9339665035160399\t2\nyahoo.com\t2020\t4\t1\tLondon, London, City Of, United Kingdom\t-2.1506807152659357\t2\nyahoo.com\t2020\t4\t1\tNigeria\t-0.7763195463182699\t2\nyahoo.com\t2020\t4\t1\tPanama Canal, Florida, United States\t-3.2308499826898798\t2\nyahoo.com\t2020\t4\t1\tAdelaide, South Australia, Australia\t-4.83870967741935\t1\nyahoo.com\t2020\t4\t1\tBedford, New York, United States\t0.0\t1\nyahoo.com\t2020\t4\t1\tCarnegie Hall, New York, United States\t1.77514792899408\t1\nyahoo.com\t2020\t4\t1\tIndiana, United States\t-2.21311475409836\t1\nyahoo.com\t2020\t4\t1\tBengaluru, Karnataka, India\t-2.90909090909091\t1\nyahoo.com\t2020\t4\t1\tColombia\t-2.5\t1\nyahoo.com\t2020\t4\t1\tDouala, Littoral, Cameroon\t1.77514792899408\t1\nyahoo.com\t2020\t4\t1\tIraq\t-3.32778702163062\t1\nyahoo.com\t2020\t4\t1\tLiberia\t1.01010101010101\t1\nyahoo.com\t2020\t4\t1\tMekong Delta, Vietnam (General), Vietnam, Republic Of\t-2.67175572519084\t1\nyahoo.com\t2020\t4\t1\tBenin\t1.77514792899408\t1\nyahoo.com\t2020\t4\t1\tColorado, United States\t-2.21311475409836\t1\nyahoo.com\t2020\t4\t1\tCzech Republic\t-1.93050193050193\t1\nyahoo.com\t2020\t4\t1\tElmhurst, New York, United States\t0.0\t1\nyahoo.com\t2020\t4\t1\tGuangdong, Jilin, China\t1.38150903294368\t1\nyahoo.com\t2020\t4\t1\tKarnataka, Karnataka, India\t-0.196850393700787\t1\nyahoo.com\t2020\t4\t1\tKentucky, United States\t-2.21311475409836\t1\nyahoo.com\t2020\t4\t1\tLibya\t-3.32778702163062\t1\nyahoo.com\t2020\t4\t1\tMacau\t-1.27591706539075\t1\nyahoo.com\t2020\t4\t1\tMelbourne, Victoria, Australia\t-4.83870967741935\t1\nyahoo.com\t2020\t4\t1\tMiami, Florida, United States\t-1.7\t1\nyahoo.com\t2020\t4\t1\tBrisbane, Queensland, Australia\t-4.83870967741935\t1\nyahoo.com\t2020\t4\t1\tBroward County, Florida, United States\t-1.65562913907285\t1\nyahoo.com\t2020\t4\t1\tNorth Dakota, United States\t-2.21311475409836\t1\nyahoo.com\t2020\t4\t1\tConnecticut, United States\t-5.83941605839416\t1\nyahoo.com\t2020\t4\t1\tDelaware, United States\t-5.83941605839416\t1\nyahoo.com\t2020\t4\t1\tDelhi, Delhi, India\t-0.196850393700787\t1\nyahoo.com\t2020\t4\t1\tSri Lanka\t-0.196850393700787\t1\nyahoo.com\t2020\t4\t1\tGeorgetown University, District Of Columbia, United States\t-8.19209039548022\t1\nyahoo.com\t2020\t4\t1\tHaryana, Haryana, India\t-0.196850393700787\t1\nyahoo.com\t2020\t4\t1\tHubei, Guangdong, China\t-1.70575692963753\t1\nyahoo.com\t2020\t4\t1\tWuhan, Hubei, China\t-2.21311475409836\t1\nyahoo.com\t2020\t4\t1\tKazakhstan\t-2.67175572519084\t1\nyahoo.com\t2020\t4\t1\tKobe, Hyogo, Japan\t-4.80607082630691\t1\nyahoo.com\t2020\t4\t1\tKuwait\t-3.32778702163062\t1\nyahoo.com\t2020\t4\t1\tLife Tabernacle Church, Louisiana, United States\t-2.82375851996105\t1\nyahoo.com\t2020\t4\t1\tMadhya Pradesh, Madhya Pradesh, India\t-0.196850393700787\t1\nyahoo.com\t2020\t4\t1\tMalaysia\t-0.196850393700787\t1\nyahoo.com\t2020\t4\t1\tMexico\t-4.88721804511278\t1\nyahoo.com\t2020\t4\t1\tMichigan, United States\t-2.21311475409836\t1\nyahoo.com\t2020\t4\t1\tMinneapolis, Minnesota, United States\t-5.83941605839416\t1\nyahoo.com\t2020\t4\t1\tMissouri, United States\t-2.21311475409836\t1\nyahoo.com\t2020\t4\t1\tNebraska, United States\t-2.21311475409836\t1\nyahoo.com\t2020\t4\t1\tNew Delhi, Delhi, India\t-0.196850393700787\t1\nyahoo.com\t2020\t4\t1\tCameroon\t1.77514792899408\t1\nyahoo.com\t2020\t4\t1\tNorway\t-1.32827324478178\t1\nyahoo.com\t2020\t4\t1\tOdisha, Orissa, India\t-0.196850393700787\t1\nyahoo.com\t2020\t4\t1\tOregon, United States\t-2.21311475409836\t1\nyahoo.com\t2020\t4\t1\tPanama\t-1.7\t1\nyahoo.com\t2020\t4\t1\tPhilippines\t-2.67175572519084\t1\nyahoo.com\t2020\t4\t1\tSan Antonio, Texas, United States\t-4.80607082630691\t1\nyahoo.com\t2020\t4\t1\tSeattle, Washington, United States\t-0.560747663551402\t1\nyahoo.com\t2020\t4\t1\tDenison University, Ohio, United States\t-2.82375851996105\t1\nyahoo.com\t2020\t4\t1\tSwitzerland\t-0.973574408901252\t1\nyahoo.com\t2020\t4\t1\tSydney, New South Wales, Australia\t-4.83870967741935\t1\nyahoo.com\t2020\t4\t1\tTehran, Tehran, Iran\t1.45985401459854\t1\nyahoo.com\t2020\t4\t1\tGreece\t-1.91256830601093\t1\nyahoo.com\t2020\t4\t1\tUniversity Of Cincinnati, Ohio, United States\t-2.82375851996105\t1\nyahoo.com\t2020\t4\t1\tUniversity Of Washington, Washington, United States\t-2.21311475409836\t1\nyahoo.com\t2020\t4\t1\tVenezuela\t-3.32778702163062\t1\nyahoo.com\t2020\t4\t1\tIllinois, United States\t-3.57142857142857\t1\nyahoo.com\t2020\t4\t1\tXin Ding, Jiangsu, China\t1.38150903294368\t1\nyahoo.com\t2020\t4\t1\tYena, Gansu, China\t-4.23162583518931\t1\nyahoo.com\t2020\t4\t1\tKyrgyzstan\t-0.196850393700787\t1\nyahoo.com\t2020\t4\t1\tLithuania\t-1.93050193050193\t1\nyahoo.com\t2020\t4\t1\tMaryland, United States\t-2.21311475409836\t1\nyahoo.com\t2020\t4\t1\tMexico City, Distrito Federal, Mexico\t-4.88721804511278\t1\nyahoo.com\t2020\t4\t1\tMinnesota, United States\t-5.83941605839416\t1\nyahoo.com\t2020\t4\t1\tMoldova\t-1.93050193050193\t1\nyahoo.com\t2020\t4\t1\tNepal\t-0.196850393700787\t1\nyahoo.com\t2020\t4\t1\tNew Jersey, United States\t-2.21311475409836\t1\nyahoo.com\t2020\t4\t1\tNew Orleans, Louisiana, United States\t-2.21311475409836\t1\nyahoo.com\t2020\t4\t1\tNorth Carolina, United States\t-2.21311475409836\t1\nyahoo.com\t2020\t4\t1\tOklahoma, United States\t-3.57142857142857\t1\nyahoo.com\t2020\t4\t1\tPakistan\t-2.67175572519084\t1\nyahoo.com\t2020\t4\t1\tPerth, Western Australia, Australia\t-4.83870967741935\t1\nyahoo.com\t2020\t4\t1\tRikers Island, New York, United States\t-5.83941605839416\t1\nyahoo.com\t2020\t4\t1\tSan Diego, California, United States\t-1.65562913907285\t1\nyahoo.com\t2020\t4\t1\tSeoul, Soul-T'ukpyolsi, South Korea\t-4.23162583518931\t1\nyahoo.com\t2020\t4\t1\tShanghai, Shanghai, China\t1.38150903294368\t1\nyahoo.com\t2020\t4\t1\tSouth Korea\t-4.23162583518931\t1\nyahoo.com\t2020\t4\t1\tTamil Nadu, Tamil Nadu, India\t-0.196850393700787\t1\nyahoo.com\t2020\t4\t1\tTelangana, Andhra Pradesh, India\t-0.196850393700787\t1\nyahoo.com\t2020\t4\t1\tThe White House, District Of Columbia, United States\t-2.21311475409836\t1\nyahoo.com\t2020\t4\t1\tUnited Arab Emirates\t-1.70575692963753\t1\nyahoo.com\t2020\t4\t1\tUniversity Of Missouri, Missouri, United States\t-2.21311475409836\t1\nyahoo.com\t2020\t4\t1\tUttar Pradesh, Uttar Pradesh, India\t-0.196850393700787\t1\nyahoo.com\t2020\t4\t1\tVietnam, Republic Of\t-2.67175572519084\t1\nyahoo.com\t2020\t4\t1\tWestchester, New York, United States\t0.0\t1\nyahoo.com\t2020\t4\t1\tWoodinville, Washington, United States\t-0.560747663551402\t1\nyahoo.com\t2020\t4\t1\tYokohama, Kanagawa, Japan\t-1.7\t1\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-20-125.ec2.internal:4040/jobs/job?id=30"],"interpreterSettingId":"spark"}}},{"user":"anonymous","dateUpdated":"2021-01-27T17:05:46+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611766400390_1206130255","id":"20210121-104759_1533596663","dateCreated":"2021-01-27T16:53:20+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:10654"}],"name":"GDELT_aws_final","id":"2FX9PJDCJ","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}